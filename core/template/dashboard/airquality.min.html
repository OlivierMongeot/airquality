<div class="eqLogic eqLogic-widget allowResize allowReorderCmd col2" style="border:#border#;border-radius:#border-radius#; background-color: #background-color#; color: #color#;width: #width#;height: #height#; #style#" data-eqLogic_id="#id#" data-eqLogic_uid="#uid#" data-version="#version#" data-category="#category#"
     data-tags="#tags#"><span class="statusCmd"></span><span class="cmd refresh pull-right cursor" data-cmd_id="#refresh_id#"><i class="fas fa-sync"></i></span><span class="cmd cmd-widget" data-cmd_id="#refresh_id#" style="display:none;"></span>
     <center class="widget-name"><strong><a href="#eqLink#" style="font-size : 1.1em;#hideEqLogicName#">#name_display# <span style="font-size: 0.85em;position: relative;top:-2px;"
 hidden>#object_name#</span></a></strong></center>
<style>
    .aqi-#id#-row {
        display: flex;
        align-items: center;
        flex-direction: row;
        justify-content: space-around;
    }

    .aqi-#id#-particule {
        display: flex;
        align-items: center;
        flex-direction: column;
        justify-content: center;
    }

    .aqi-#id#-space {
        margin-top: 10px;
    }

    .aqi-#id#-aqi {
        margin-top: 5px;
    }

    .aqi-#id#-value,
    .aqi-#id#-label,
    .contain-minmax-#id#{
        margin-top: 5px;
    }

    .aqi-#id#-label {
        max-width: 50px;
        text-align: center;
    }

    #airquality-min#uid#>.carousel-control {
        position: absolute;
        top: 55%;
        z-index: 5;
        display: inline-block;
        margin-top: 0px;
        width: 20px;
    }

    .header-#id#-container {
        margin-top: 15px;
        display: flex;
        align-items: center;
        flex-direction: row;
        justify-content: space-around;
        vertical-align: middle;
    }

    .header-#id#-min {
        display: flex;
        align-items: center;
        flex-direction: column;
        justify-content: center;
    }

    .active-aqi-#id#{
         margin:15px 0 0 0;
    }


/*     highchart  */
.highcharts-figure, .highcharts-data-table table {
  min-width: 250px; 
  max-width: 800px;
  height: auto;
  margin: 0 auto;
}

.highcharts-data-table table {
	font-family: Verdana, sans-serif;
	border-collapse: collapse;
	border: 1px solid #EBEBEB;
	margin: 5px auto;
	text-align: center;
	width: 100%;
	max-width: 500px;
}
.highcharts-data-table caption {
  padding: 1em 0;
  font-size: 1.2em;
  color: #555;
}
.highcharts-data-table th {
	font-weight: 600;
  padding: 0.5em;
}
.highcharts-data-table td, .highcharts-data-table th, .highcharts-data-table caption {
  padding: 0.5em;
}
.highcharts-data-table thead tr, .highcharts-data-table tr:nth-child(even) {
  background: #f8f8f8;
}
.highcharts-data-table tr:hover {
  background: #f1f7ff;
}
</style>
<div class="aqi-#id#-container">
    <div class="header-#id#-container">
      
        <div class="#history# tooltips header-#id#-min" data-type="info" data-subtype="other" data-cmd_id="#uvid#">
            <div title="Cliquez pour + d'info" id="info-modal#uvid#" class="cursor aqi-#id#-image tooltips">#icone_uv#</div>
            <div class="cmd noRefresh aqi-#id#-label-aqi">#uv_name#</div>
            <div class="cmd noRefresh aqi-#id#-aqi">#uv#</div>
        </div>
  
  
        <div class="#history# tooltips header-#id#-min" data-type="info" data-subtype="other" data-cmd_id="#aqiid#">    
           <!--  -->
            <div title="Cliquez pour + d'info" id="info-modal#aqiid#" class="aqi-#id#-image tooltips cursor">#icone_aqi#</div>
           <!--  -->
            <div style="font-size: 1.8rem;" class="cmd noRefresh  aqi-#id#-aqi">#aqi_name#</div>
            <div style="font-size: 1.2rem;" class="cmd noRefresh aqi-#id#-space">#aqi#</div>
        </div>

        <div class="#history# tooltips header-#id#-min" data-type="info" data-subtype="other" data-cmd_id="#visibilityid#">
            <div  title="Cliquez pour + d'info" id="info-modal#visibilityid#" class="cursor aqi-#id#-image tooltips">#icone_visibility#</div>
            <div class="cmd noRefresh">#visibility_name#</div>
            <div title="#visibility#  m" class="cmd noRefresh aqi-#id#-aqi">#visibility#</div>
        </div>    
    </div>


    <div title="#updatedAt#" class="cmd header-#id#-min active-aqi-#id# ">
       #index_name# : #aqiinfo# 
    </div>

    <figure class="highcharts-figure">
        <div id="container#id#"></div>
    </figure>

    <div id="airquality-min#uid#" class="carousel slide aqi-#id#-space" data-ride="carousel" data-pause="hover" #classCaroussel#>
        <div class="carousel-inner" id="chart#id#">#mini_slide#</div>
        <a class="left carousel-control my#id#" href="#airquality-min#uid#" data-slide="prev"
            style="background:transparent">
            <i class="fas fa-chevron-left"></i>
        </a>
        <a class="right carousel-control my#id#" href="#airquality-min#uid#" data-slide="next"
            style="background:transparent">
            <i class="fas fa-chevron-right"></i>
        </a>
    </div>

 
</div>
<script>
            
// A point click event that uses the Renderer to draw a label next to the point
// On subsequent clicks, move the existing label instead of creating a new one.
// Highcharts.addEvent(Highcharts.Point, 'click', function () {
//   if (this.series.options.className.indexOf('popup-on-click') !== -1) {
//     const chart = this.series.chart;
//     const date = Highcharts.dateFormat('%A, %b %e, %Y', this.x);
//     const text = `<b>${date}</b><br/>${this.y} ${this.series.name}`;

//     const anchorX = this.plotX + this.series.xAxis.pos;
//     const anchorY = this.plotY + this.series.yAxis.pos;
//     const align = anchorX < chart.chartWidth - 200 ? 'left' : 'right';
//     const x = align === 'left' ? anchorX + 10 : anchorX - 10;
//     const y = anchorY - 30;
//     if (!chart.sticky) {
//       chart.sticky = chart.renderer
//         .label(text, x, y, 'callout',  anchorX, anchorY)
//         .attr({
//           align,
//           fill: 'rgba(0, 0, 0, 0.75)',
//           padding: 10,
//           zIndex: 10000 // Above series, below tooltip
//         })
//         .css({
//           color: 'white'
//         })
//         .on('click', function () {
//           chart.sticky = chart.sticky.destroy();
//         })
//         .add();
//     } else {
//       chart.sticky
//         .attr({ align, text })
//         .animate({ anchorX, anchorY, x, y }, { duration: 250 });
//     }
//   }
// });



Highcharts.chart('container#id#', {

  chart: {
    spacingTop: 0,
    type: 'spline',
    height: 200,

    // scrollablePlotArea: {
    //   minWidth: 200,
    //   scrollPositionX: 1
    // }
  },
  exporting: {
    enabled: false
  },
  credits:{
    enabled: false
  },

//   data: {
//     csvURL: 'https://cdn.jsdelivr.net/gh/highcharts/highcharts@v7.0.0/samples/data/analytics.csv',
//     beforeParse: function (csv) {
//       return csv.replace(/\n\n/g, '\n');
//     }
//   },

  title: {
    text: null,
    y:25,
    x:0,
    style :{
        color:'currentColor'
    }
  },

//   subtitle: {
//     text: 'Source: Google Analytics'
//   },

  xAxis: {
    // type: 'datetime',
    labels: {
            overflow: 'justify'
        },
    categories: ['6h', '8h', '10h', '12h', '14h', '16h', '18h', '20h',
            '22h', '24h', '2h', '4h'],
    // tickInterval: 7 * 24 * 3600 * 1000, // one week
    tickWidth: 0,
    gridLineWidth: 0,

    labels: {
    //   align: 'left',
     x: 3,
      y: 10
    }
  },

  yAxis: [{ // left y axis
    visible:false,
    title: {
      text: null
    },
    labels: {
      align: 'left',
      x: 0,
      y: 0,
      format: '{value:.,0f}'
    },
    showFirstLabel: false
  }],

  legend: {
    align: 'center',
    verticalAlign: 'bottom',
    borderWidth: 0
  },

  tooltip: {
    shared: true,
    crosshairs: true
  },

  plotOptions: {
    spline: {
            lineWidth: 4,
            states: {
                hover: {
                    lineWidth: 5
                }
            },
            marker: {
                enabled: false
            },
            // pointInterval: 7200000, // two hour
            // pointStart: Date.UTC(2018, 1, 13, 0, 0, 0)
        },
    column: {
      pointPadding: 0.2,
      borderWidth: 0
    },
    series: {
      cursor: 'pointer',
      className: 'popup-on-click',
      marker: {
        lineWidth: 1
      }
    }
  },

  series: [
    {
    name: 'AQI',
    lineWidth: 8,
    marker: {radius: 2},
    data: [7.0, 6.9, 9.5, 14.5, 18.2, 21.5, 25.2, 26.5, 23.3, 18.3, 13.9, 9.6]
    },
    {
    name: 'O³',
    marker: {radius: 2},
    data: [ 3.9, 4.2, 5.7, 8.5, 11.9, 15.2, 17.0, 16.6, 14.2, 10.3, 6.6, 4.8]
    },
    {
    name: 'NH³',
    marker: {radius: 2},
    data: [ 5.9, 6.2, 2.7, 3.5, 6.9, 9.2, 12.0, 11.6, 10.2, 8.3, 6.6, 2.8]
    }
]
});

                // Highcharts.chart('container#id#', {
                //     chart: {
                //         type: 'column',
                //         scrollablePlotArea: { minWidth: 400 }
                //     },
                //     title: {
                //         text: 'Prévison AQI'
                //     },
                //     // subtitle: {
                //     //     text: 'Source: WorldClimate.com'
                //     // },
                //     xAxis: {
                //         categories: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun',
                //             'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec']
                //     },
                //     yAxis: {
                //         title: {
                //             text: 'Concentration'
                //         },
                //         labels: {
                //             formatter: function () {
                //                 return this.value + 'mg/m³';
                //             }
                //         }
                //     },
                //     tooltip: {
                //         crosshairs: true,
                //         shared: true
                //     },
                //     plotOptions: {
                //         spline: {
                //             marker: {
                //                 radius: 4,
                //                 lineColor: '#666666',
                //                 lineWidth: 1
                //             }
                //         }
                //     },
                //     series: [{
                //         name: 'Aqi',
                //         marker: {
                //             symbol: 'square'
                //         },
                //         data: [7.0, 6.9, 9.5, 14.5, 18.2, 21.5, 25.2, 26.5, 23.3, 18.3, 13.9, 9.6]

                //     }, {
                //         name: 'O³',
                //         marker: {
                //             symbol: 'diamond'
                //         },
                //         data: [ 3.9, 4.2, 5.7, 8.5, 11.9, 15.2, 17.0, 16.6, 14.2, 10.3, 6.6, 4.8]
                //     }]
                // });




// Boite Modal Info     

    $(document).on ("click", "#info-modal#aqiid#", function () {
       
        $('#md_modal2').dialog({
        title: "Info AQI"
        });
        $('#md_modal2').load('index.php?v=d&plugin=airquality&modal=InfoAqi&id=#id#&logical_id=#aqiid#').dialog('open');
        });
    
    $(document).on ("click", "#info-modal#uvid#", function () {
       
        $('#md_modal2').dialog({
        title: "Info UV"
        });
        $('#md_modal2').load('index.php?v=d&plugin=airquality&modal=InfoUv&id=#id#&logical_id=#uvid#').dialog('open');
        });

    $(document).on ("click", "#info-modal#visibilityid#", function () {
       
        $('#md_modal2').dialog({
        title: "Info Visibilité"
        });
        $('#md_modal2').load('index.php?v=d&plugin=airquality&modal=InfoVisibility&id=#id#&logical_id=#visibilityid#').dialog('open');
        });
    

    $(document).on ("click", ".info-modal#pm10id#", function () {
    
        $('#md_modal2').dialog({
        title: "Info Particules Fines"
        });
        $('#md_modal2').load('index.php?v=d&plugin=airquality&modal=InfoPm25&id=#pm10id#').dialog('open');
                });


    $(document).on ("click", ".info-modal#o3id#", function () {
        $('#md_modal2').dialog({
        title: "Info Ozone"
        });
        $('#md_modal2').load('index.php?v=d&plugin=airquality&modal=InfoO3&id=#o3id#').dialog('open');
        });

    // $(document).on ("click", "#info-modal#nh3id#", function () {
    //     $('#md_modal2').dialog({
    //     title: "Info Ammoniac"
    //     });
    //     $('#md_modal2').load('index.php?v=d&plugin=airquality&modal=InfoNh3&id=#nh3id#').dialog('open');
    //     });
    // $(document).on ("click", "#info-modal#so2id#", function () {
    //     $('#md_modal2').dialog({
    //     title: "Info Dioxyde de Souffre"
    //     });
    //     $('#md_modal2').load('index.php?v=d&plugin=airquality&modal=InfoSo2&id=#so2id#').dialog('open');
    //     });
    // $(document).on ("click", "#info-modal#no2id#", function () {
    //     $('#md_modal2').dialog({
    //     title: "Info Dioxyde d'Azote"
    //     });
    //     $('#md_modal2').load('index.php?v=d&plugin=airquality&modal=InfoNo2&id=#no2id#').dialog('open');
    //     });
    // $(document).on ("click", "#info-modal#noid#", function () {
    //     $('#md_modal2').dialog({
    //     title: "Info Monoxyde d'Azote"
    //     });
    //     $('#md_modal2').load('index.php?v=d&plugin=airquality&modal=InfoNo&id=#noid#').dialog('open');
    //     });

              /*   var mySlider#id# = $('#airquality-min#uid#').carousel()

             $('#airquality-min#uid#').hover(function () {
                    console.log('pause')
                    mySlider#id#.carousel('pause');
               }, function () {
                    mySlider#id#.carousel({
                         'pause': false
                    });
                    console.log('restart')
               });*/
$(document).ready(function () {

    
               if ('#animation#'== 'active') {
                    var t#uid#;

                    var start#uid# = $('#airquality-min#uid#').find('.active').attr('data-interval');
                    t#uid# = setTimeout("$('#airquality-min#uid#').carousel({interval: 1000});",
                         start#uid# - 1000);

                    $('#airquality-min#uid#').on('slid.bs.carousel', function () {
                         clearTimeout(t#uid#);
                         var duration#uid# = $(this).find('.active').attr('data-interval');

                         $('#airquality-min#uid#').carousel('pause');
                         t#uid# = setTimeout("$('#airquality-min#uid#').carousel();",
                              duration#uid# - 1000);
                    })
                    $('.right.carousel-control.my#id#').on('click', function () {
                         clearTimeout(t#uid#);
                    });
                    $('.left.carousel-control.my#id#').on('click', function () {
                         clearTimeout(t#uid#);
                    });
               }


               $('.eqLogic[data-eqLogic_uid=#uid#] .cmd').on('click', function () {
                    jeedom.cmd.execute({ id: $(this).data('cmd_id') });
                    });
});
</script>
</div>